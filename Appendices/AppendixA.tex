% !TEX root = ../Thesis.tex
% !TEX output_directory = ../
\chapter{Το Σύνολο Δεδομένων Και Οι Τροποποιήσεις Στις Οποίες Προβήκαμε} \label{dataset}




\begin{table}
	\begin{tabular}{|p{13.5cm}|}
		\hline
		Actions in MPII Cooking Activities Dataset \\ \hline
		Background activity, change temperature, cut apart, cut dice, cut in, cut off ends, cut out inside, cut slices, cut stripes, dry, fill water from tap, grate, lid: put on, lid: remove, mix, move from X to Y, open egg, open tin, open/close cupboard, open/close drawer, open/close fridge, open/close oven, package X, peel, plug in/out, pour, pull out, puree, put in bowl, put in pan/pot, put on bread/dough, put on cutting-board, put on plate, read, remove from package, rip open, scratch off, screw close, screw open, shake, smell, spice, spread, squeeze, stamp, stir, strew, take \& put in cupboard, take \& put in drawer, take \& put in fridge, take \& put in oven, take \& put in spice holder, take ingredient apart, take out from cupboard, take out from drawer, take out from fridge, take out from oven, take out from spice holder, taste, throw in garbage, unroll dough, wash hands, wash objects, whisk, wipe clean. \\
		\hline
	\end{tabular}
	\caption{Οι 65 δράσεις του συνόλου δεδομένων MPII Cooking Activities Dataset. Στα πειράματά μας, οι δράσεις put on cutting-board, read και smell ενσωματώνονται στην κατηγορία background activity και η δράση wash hands συνενώνεται με τη δράση wash hands.}
	\label{tab:DataActions}
\end{table}



\par Τα 44 βίντεο ακολουθούν μια σύμβαση ονομασίας τύπου sSS-dDD, με τα SS και DD να αποτελούν διψήφιους αριθμούς που υποδεικνύουν το υποκείμενο, δράστη του βίντεο που εκτελεί τη συνταγή, (s από το subject) και το πιάτο-συνταγή (d από το dish) αντίστοιχα. Για παράδειγμα, έγκυρη ονομασία είναι η s19-d07, που υποδηλώνει ότι ο δράστης 19 εκτελεί τη συνταγή 7. Στο σύνολο των 44 βίντεο, εμφανίζονται διάφοροι συνδυασμοί υποκειμένων από το 8 ως το 20 και πιάτων από το 1 ως το 14. Είναι φανερό ότι το σύνολο δεδομένων περιέχει ένα υποσύνολο όλων των πιθανών συνδυασμών δραστών και συνταγών. Τα βίντεο που περιέχονται φαίνονται στον πίνακα \ref{tab:DataVideos}. Από αυτά, επιλέχθηκαν ως βίντεο εκπαίδευσης όσα αφορούν τους δράστες 11 ως 15. Επειδή κάποιες κατηγορίες δεν περιέχονταν στα βίντεο αυτά, προσθέσαμε στα βίντεο εκπαίδευσης επιπλέον τα s08-d02 και s10-d10. Όλα τα βίντεο είναι πυκνά δειγματοληπτημένα στα 29.4 frames ανά δευτερόλεπτο. Η συνολική διάρκεια των βίντεο, εκπαίδευσης και ελέγχου είναι περίπου 8 ώρες, επομένως ο αριθμός των συνολικών frames ξεπερνά τις 800000.

\begin{table}
    \begin{tabular}{|p{13.5cm}|}
    \hline
    Videos in MPII Cooking Activities Dataset \\ \hline
    s08-d02, s08-d04, s08-d11, s08-d14, s10-d02, s10-d10, s10-d11, s11-d01, s11-d06, s11-d11, s11-d12, s11-d13, s11-d14, s12-d05, s12-d07, s12-d09, s12-d10, s12-d14, s13-d08, s13-d09, s13-d11, s13-d12, s13-d13, s14-d08, s14-d09, s14-d11, s15-d03, s15-d07, s15-d14, s16-d01, s16-d06, s16-d09, s16-d11, s17-d02, s17-d05, s17-d13, s18-d11, s19-d01, s19-d06, s19-d07, s19-d09, s19-d10, s19-d12, s20-d07. \\
    \hline
    \end{tabular}
	\caption{Τα 44 βίντεο του συνόλου δεδομένων MPII Cooking Activities Dataset. Από αυτά, χρησιμοποιούμε για εκπαίδευση όσα αφορούν τους δράστες 11 ως 15 και τα s08-d02 και s10-d10.}
	\label{tab:DataVideos}
\end{table}



\par Το σύνολο MPII Cooking 2 Dataset περιέχει επισημειώσεις αρκετά πλουσιότερες αυτών του MPII Cooking Activities Dataset. Αρχικά, παρέχονται επισημειώσεις δράσεων για κάθε βίντεο στη μορφή: έναρξη (σε χρόνο και frames) και λήξη δράσης, είδος δράσης, δράστης και σύνολο αντικειμένων που πλαισιώνουν τη δράση. Τα αντικείμενα αυτά χωρίζονται επιπλέον σε εργαλεία και υλικά, αλλά η διάκριση αυτή δεν αφορά την εργασία μας. Με βάση τις επισημειώσεις αυτές, αποκτούμε έναν χρονικό χάρτη των αντικειμένων που εμφανίζονται στο βίντεο. Βέβαια υπογραμμίζουμε το ότι οι επισημειώσεις αυτές αφορούν τα αντικείμενα που χρησιμοποιούνται στην κάθε δράση και όχι αυτά που εμφανίζονται οπτικά στο βίντεο σε κάθε χρονική στιγμή. Τα αντικείμενα που εμφανίζονται κατατάσσονται σε 155 κατηγορίες, από τις οποίες μας ενδιαφέρουν μόνο οι 92, καθώς αυτές εμφανίζονται στα βίντεο του MPII Cooking Activities Dataset. Επιπλέον, στις 92 κατηγορίες δεν περιλαμβάνονται συγκεκριμένα ουσιαστικά όπως χέρι και πάγκος, καθώς δεν δίνουν ιδιαίτερη πληροφορία για τη δράση. Το σύνολο των ουσιαστικών που χρησιμοποιούνται στα πειράματά μας φαίνεται στον πίνακα \ref{tab:DataNouns}.

\begin{table}
    \begin{tabular}{|p{13.55cm}|}
    \hline
    Objects in MPII Cooking 2 Dataset \\ \hline
    apple, baking tray, blender, bottle, bowl, box grater, bread, bread knife, butter, carrot, cheese, chefs knife, chocolate, colander, corn, cucumber, cup, cupboard, dough, drawer, egg, eggshell, electricity column, electricity plug, flat grater, fridge, front peeler, frying pan, garbage, garlic clove, glass, ham, hot chocolate powder bag, jar, kiwi, knife, kohlrabi, ladle, lemon, lid, masher, measuring pitcher, milk, mushroom, oil, onion, orange, oven, paper, paper box, peach, pear, peel, pepper, pineapple, plastic bag, platic bottle, plastic box, plastic paper bag, plate, plum, pot, potato, puree, salad, salami, salt, seed, side peeler, sink, soup, spatula, spice, spice holder, spice shaker, sponge, sponge cloth, spoon, squeezer, stone, stove, tap, teaspoon, tin, tin opener, tomato, towel, water, wire whisk, wrapping paper, yolk, zucchini. \\
    \hline
    \end{tabular}
	\caption{Οι 92 κατηγορίες αντικειμένων που εμφανίζονται στα βίντεο του συνόλου MPII Cooking Activities Dataset και που χρησιμοποιούμε στα πειράματά μας.}
	\label{tab:DataNouns}
\end{table}


\section{Επιπλέον Επισημειώσεις Στις Οποίες Προβήκαμε}
\subsection{Υπότιτλοι}
Για την αξιοποίηση της ομιλίας ως τρόπο έκφρασης επιπλέον πληροφορίας, προβαίνουμε σε ανάλυση υποτίτλων, ώστε να αποφύγουμε τα σφάλματα που θα εισήγαγε ένα σύστημα αυτόματης αναγνώρισης λόγου, καθώς αυτό ξεφεύγει από τον σκοπό αυτής της εργασίας. Επειδή δεν υπάρχουν υπότιτλοι για το MPII Cooking Activities Dataset, δημιουργήσαμε εμείς. Σε ένα σύνολο επισημειωτών δόθηκε το βίντεο και οι επισημειώσεις δράσεων και αντικειμένων από το MPII Cooking 2 Dataset. Επιβάλλαμε τον περιορισμό της χρήσης των ονομάτων των αντικειμένων απευθείας και όχι συνωνύμων τους, καθώς στη χρήση των υποτίτλων αναζητούμε μόνο τα ονόματα των αντικειμένων όπως αυτά παρέχονται από το MPII Cooking 2 Dataset. Όσον αφορά τους χρόνους ενός επιλόγου, επιβάλλαμε να εκτείνονται εντός της διάρκειας της δράσης και το χρονικό τους μήκος να περιορίζεται κάτω από τα 15 δευτερόλεπτα, ανάλογα πάντα με το μέγεθος του διαλόγου σε λέξεις. Προσπαθήσαμε να διατηρήσουμε τη φυσικότητα των υποτίτλων και ταυτόχρονα να διευκολύνουμε την ανίχνευση αντικειμένων μέσω αυτών. Στον πίνακα \ref{tab:DataSubtitles} φαίνεται ένα παράδειγμα τμήματος των υποτίτλων για το βίντεο s08-d04.

\begin{table}
    \begin{tabular}{ | l | l | l |}
    \hline
    Start Time & End Time & Subtitle \\ \hline
    714.7200 & 722.7210 & Pour enough oil to fill the bottom of your frying-pan. \\ \hline
	723.0950 & 726.9380 & Spread it uniformly. \\ \hline
	728.4170 & 730.6840 & Ok, turn on the stove in this point. \\ \hline
	730.7240 & 734.8660 & Choose a high temperature for start. \\
    \hline
    \end{tabular}
	\caption{Παράδειγμα υποτίτλων για το βίντεο s08-d04. Όλοι οι χρόνοι αναφέρονται σε δευτερόλεπτα από την αρχή του βίντεο.}
	\label{tab:DataSubtitles}
\end{table}


\subsection{Επισημειώσεις Αντικειμένων}
Το σύνολο MPII Cooking 2 Dataset περιέχει επισημειώσεις για τα αντικείμενα που χρησιμοποιούνται ανά δράση. Ωστόσο, οπτική επισημείωση, για τη θέση δηλαδή του χρησιμοποιούμενου αντικειμένου στα frames, δεν υπάρχει. Προκειμένου να εντοπίσουμε οπτικά τα αντικείμενα στα frames του βίντεο, είναι φανερό ότι πρέπει να έχουμε δεδομένα για την εμφάνιση τους. Καθώς η μεταβλητότητα των αντικειμένων είναι εξαιρετικά μεγάλη (όπως αναλύουμε στο κεφάλαιο 4), δημιουργούμε μοντέλα αντικειμένων για κάθε βίντεο ξεχωριστά. Η δημιουργία επισημειώσεων έγινε σε δύο στάδια, τα οποία εξυπηρετούν διαφορετικούς σκοπούς.

\par Σε πρώτη φάση, δειγματοληπτούμε το βίντεο με περίοδο 100 frames και σε κάθε ένα σημειώνουμε τα αντικείμενα που εμφανίζονται. Η διαδικασία αυτή γίνεται με τη λειτουργία trainingImageLabeler του λογισμικού MATLAB. Με το λογισμικό αυτό, είναι εύκολο να δημιουργηθεί ένα ορθογώνιο που περιλαμβάνει την περιοχή ενδιαφέροντος. Ο χρήστης εισάγει τα ορθογώνια και τις ετικέτες και το πρόγραμμα εξάγει τις χωρικές συντεταγμένες πάνω στο frame. Ένα παράδειγμα φαίνεται στην παρακάτω εικόνα:

\begin{figure}[H]
  \centering
  \noindent\makebox[\textwidth]{\includegraphics[scale=0.25]{{Images/AppMatlab}.jpg}}
  \caption{Παράδειγμα δημιουργίας επισημειώσεων με το λογισμικό trainingImageLabeler του MATLAB. Εισάγουμε τα ορθογώνια και την ετικέτα και το λογισμικό εξάγει τις συντεταγμένες. Η χρήση του πακέτου αυτου διευκολύνει τη μαζική δημιουργία θετικών δειγμάτων εκπαίδευσης για ανιχνευτές αντικειμένων.}
  \label{fig:AppMatlab}
\end{figure}



\begin{figure}[H]
  \centering
  \noindent\makebox[\textwidth]{\includegraphics[scale=0.25]{{Images/AppFridge}.jpg}}
  \caption{Παράδειγμα αναπαράστασης σταθερού αντικειμένου με το τμήμα του το οποίο εμφανίζεται μόνο όταν το αντικείμενο χρησιμοποιείται. Έτσι, εξασφαλίζεται ότι το αντικείμενο θα εντοπίζεται μόνο σε περιπτώσεις ενδιαφέροντος και όχι σε όλη τη διάρκεια του βίντεο.}
  \label{fig:AppFridge}
\end{figure}

\par Οι επισημειώσεις αυτές λειτουργούν ως θετικά δείγματα για εκπαίδευση ενός ανιχνευτή αντικειμένων. Λόγω της υψηλής μεταβλητότητας, επιλέξαμε τη χρήση Ταιριάσματος Προτύπων (Template Matching) ως ανιχνευτή αντικειμένων κι έτσι απαιτούνταν να συλλέξουμε πρότυπα. Έχοντας λοιπόν τις πλήρεις επισημειώσεις μέσω του trainingImageLabeler, επιλέξαμε αυτές που εμφανίζοταν συχνά και για μεγάλη χρονική διάρκεια ως αντιπροσώπους κλάσεων αντικειμένων. Πρακτικά, συρρικνώνουμε τα θετικά δείγματα έτσι ώστε να ελαχιστοποιείται η απώλεια που αυτό συνεπάγεται στην μεταβλητότητα και στον ικανοποιητικό εντοπισμό. Στο κεφάλαιο 4 αναλύουμε περισσότερα για τη μέθοδο εντοπισμού των αντικειμένων.


\subsection{Επισημειώσεις Χεριών}
Στο κεφάλαιο 5 δείχνουμε τον εντοπισμό χεριών και την εξαγωγή του τύπου λαβής (grasping type). Στο κεφάλαιο 6, τα αποτελέσματα φαίνονται να υποβοηθούνται από αυτή την πληροφορία. Εν τούτοις, σύνολο δεδομένων δεν υπήρχε ούτε σχετικά με τον εντοπισμό χεριών, ούτε σχετικά με την εξαγωγή τύπου λαβής, που να σχετίζονται άμεσα με το MPII Cooking Activities Dataset. Επομένως, έπρεπε να δημιουργήσουμε, με βάση τις διαθέσιμες πληροφορίες, μια βάση για τον εντοπισμό χεριών αρχικά.


\par Η έλλειψη επισημειώσεων για τον τύπο λαβής μας ανάγκασε να χρησιμοποιήσουμε μη επιβλεπόμενη μάθησης, όπως περιγράφεται στο κεφάλαιο 5. Επομένως, δημιουργούμε ένα σύνολο δεδομένων τύπων λαβής με αυτόματο τρόπο, λύνοντας το πρόβλημα απουσίας επισημειώσεων και δεν προβαίνουμε σε επιπλέον διαδικασίες επισημειώσεων.

\begin{figure}
  \centering
  \noindent\makebox[\textwidth]{\includegraphics[scale=0.35]{{Images/AppHands}.jpg}}
  \caption{Παραδείγματα επισημειώσεων πόζας. Με μπλε απεικονίζονται τα σημεία που χαρακτηρίζονται ως χέρια μέσω των επισημειώσεων πόζας. Δείχνουμε τις περιοχες ως τετράγωνα $10 \times 10$ γύρω από τα σημεία επισημείωσης για να είναι εμφανείς οπτικά στον αναγνώστη. Βλέπουμε ότι ενώ στη δεξιά εικόνα οι επισημειώσεις ταυτίζονται με τη θέση των χεριών, τα οποία είναι εμφανή οπτικά, στην εικόνα αριστερά οι επισημειώσεις δείχνουν τη θέση που βρίσκεται το χέρι πίσω από το σώμα του ανθρώπου. Είναι φανερό ότι εικόνες σαν την αριστερή δεν μπορούν να χρησιμεύσουν σαν θετικά δείγματα για έναν ανιχνευτή χεριών και έτσι αποκλείονται από τα θετικά δεδομένα εκπαίδευσης και χρησιμοποιούντι μόνο για την εξαγωγή αρνητικών παραδειγμάτων.}
  \label{fig:AppHands}
\end{figure}



